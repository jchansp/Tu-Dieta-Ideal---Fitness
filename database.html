<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Database</title>
    <script>
        var db = openDatabase('App', '1.0', 'App', 65536);

        db.transaction(function (transaction) {
            transaction.executeSql(
                'DROP TABLE IF EXISTS Dietas;',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'DROP TABLE IF EXISTS Comidas;',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'DROP TABLE IF EXISTS Pesos;',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'CREATE TABLE Dietas' +
                '(' +
                '    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,' +
                '    Calorias INTEGER NULL ' +
                ');',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
               'CREATE TABLE Comidas' +
               '(' +
               '    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,' +
               '    IdDieta INTEGER NOT NULL REFERENCES Dietas (Id) ON UPDATE CASCADE ON DELETE CASCADE,' +
               '    Nombre VARCHAR ' +
               ');',
               [],
               function (transaction, results) {
                   console.log(results);
               },
               function (transaction, error) {
                   console.log(error);
               });
            transaction.executeSql(
               'CREATE TABLE Pesos' +
               '(' +
               '    Id INTEGER NOT NULL PRIMARY KEY AUTOINCREMENT,' +
               '    Peso INTEGER NOT NULL,' +
               '    Fecha DATETIME NOT NULL ' +
               ');',
               [],
               function (transaction, results) {
                   console.log(results);
               },
               function (transaction, error) {
                   console.log(error);
               });
            transaction.executeSql(
                'INSERT' +
                '  INTO Dietas' +
                '      (Calorias)' +
                'VALUES ' +
                '      (2000);',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'INSERT' +
                '  INTO Comidas' +
                '      (IdDieta' +
                '      ,Nombre)' +
                'VALUES ' +
                '      (1' +
                '      ,\'1ª COMIDA\');',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'SELECT *' +
                '  FROM Dietas;',
                [], // array of values for the ? placeholders
                function (transaction, results) {
                    var text =
                        '<h1>Dietas</h1>' +
                        '<table border="1">' +
                        '    <tr>' +
                        '        <th>' +
                        '            Id' +
                        '        </th>' +
                        '        <th>' +
                        '            Calorias' +
                        '        </th>' +
                        '    </tr>'
                    for (var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);
                        text +=
                            '    <tr>' +
                            '        <td>' +
                            '            ' + row['Id'] +
                            '        </td>' +
                            '        <td>' +
                            '            ' + row['Calorias'] +
                            '        </td>' +
                            '    </tr>'
                    }
                    text +=
                        '</table>'
                    document.getElementsByTagName('BODY')[0].innerHTML += text;
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'SELECT *' +
                '  FROM Comidas;',
                [], // array of values for the ? placeholders
                function (transaction, results) {
                    var text =
                        '<h1>Comidas</h1>' +
                        '<table border="1">' +
                        '    <tr>' +
                        '        <th>' +
                        '            Id' +
                        '        </th>' +
                        '        <th>' +
                        '            IdDieta' +
                        '        </th>' +
                        '        <th>' +
                        '            Nombre' +
                        '        </th>' +
                        '    </tr>'
                    for (var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);
                        text +=
                            '    <tr>' +
                            '        <td>' +
                            '            ' + row['Id'] +
                            '        </td>' +
                            '        <td>' +
                            '            ' + row['IdDieta'] +
                            '        </td>' +
                            '        <td>' +
                            '            ' + row['Nombre'] +
                            '        </td>' +
                            '    </tr>'
                    }
                    text +=
                        '</table>'
                    document.getElementsByTagName('BODY')[0].innerHTML += text;
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'SELECT *' +
                '  FROM Pesos;',
                [], // array of values for the ? placeholders
                function (transaction, results) {
                    var text =
                        '<h1>Pesos</h1>' +
                        '<table border="1">' +
                        '    <tr>' +
                        '        <th>' +
                        '            Id' +
                        '        </th>' +
                        '        <th>' +
                        '            Peso' +
                        '        </th>' +
                        '        <th>' +
                        '            Fecha' +
                        '        </th>' +
                        '    </tr>'
                    for (var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);
                        text +=
                            '    <tr>' +
                            '        <td>' +
                            '            ' + row['Id'] +
                            '        </td>' +
                            '        <td>' +
                            '            ' + row['Peso'] +
                            '        </td>' +
                            '        <td>' +
                            '            ' + row['Fecha'] +
                            '        </td>' +
                            '    </tr>'
                    }
                    text +=
                        '</table>'
                    document.getElementsByTagName('BODY')[0].innerHTML += text;
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'INSERT' +
                '  INTO Pesos' +
                '      (Peso' +
                '      ,Fecha)' +
                'VALUES ' +
                '      (100' +
                '      ,\'13/13/2013\');',
                [],
                function (transaction, results) {
                    console.log(results);
                },
                function (transaction, error) {
                    console.log(error);
                });
            transaction.executeSql(
                'SELECT MAX(Fecha) AS Fecha' +
                '  FROM Pesos;',
                [], // array of values for the ? placeholders
                function (transaction, results) {
                    var text =
                        '<h1>MAXFECHA</h1>' +
                        '<table border="1">' +
                        '    <tr>' +
                        '        <th>' +
                        '            Valor' +
                        '        </th>' +
                        '    </tr>'
                    for (var i = 0; i < results.rows.length; i++) {
                        var row = results.rows.item(i);
                        text +=
                            '    <tr>' +
                            '        <td>' +
                            '            ' + row['Fecha'] +
                            '        </td>' +
                            '    </tr>'
                    }
                    text +=
                        '</table>'
                    document.getElementsByTagName('BODY')[0].innerHTML += text;
                },
                function (transaction, error) {
                    console.log(error);
                });
        });

    </script>
</head>
<body>

</body>
</html>
